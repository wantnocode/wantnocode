"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _defineProperty(e,n,t){return(n=_toPropertyKey(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function _toPropertyKey(e){e=_toPrimitive(e,"string");return"symbol"===_typeof(e)?e:String(e)}function _toPrimitive(e,n){if("object"!==_typeof(e)||null===e)return e;var t=e[Symbol.toPrimitive];if(void 0===t)return("string"===n?String:Number)(e);n=t.call(e,n||"default");if("object"!==_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}function Sankey_(){go.LayeredDigraphLayout.call(this)}function getAutoHeightForNode(e){for(var n=0,t=e.findLinksInto();t.next();)n+=t.value.computeThickness();for(var o=0,t=e.findLinksOutOf();t.next();)o+=t.value.computeThickness();e=Math.max(n,o);return e<10&&(e=10),e}function fast_layer_layout(){var e;graph_layout_type=1,myDiagram.div=null,myDiagram=GO(go.Diagram,Diagram_name,{initialAutoScale:go.Diagram.Uniform,"animationManager.isEnabled":!1,ModelChanged:function(){},layout:GO(Sankey_,{setsPortSpots:!1,direction:0,packOption:2,layerSpacing:1e3,columnSpacing:20})}),initOverview(),myDiagram.nodeTemplateMap.add("",GO(go.Node,"Vertical",new go.Binding("visible"),{visible:!0,zOrder:2,layerName:"Foreground",mouseEnter:function(){},mouseLeave:function(){},click:function(){},doubleClick:function(){send_newGraph("属性")}},new go.Binding("visible"),new go.Binding("location","loc",go.Point.parse).makeTwoWay(go.Point.stringify),GO(go.Shape,(_defineProperty(e={name:"SHAPE",figure:"Rectangle",stroke:null,strokeWidth:5,portId:"",fromSpot:go.Spot.RightSide,toSpot:go.Spot.LeftSide},"portId",""),_defineProperty(e,"cursor","pointer"),_defineProperty(e,"fromLinkable",!1),_defineProperty(e,"toLinkable",!1),_defineProperty(e,"width",20),_defineProperty(e,"opacity",1),e),{toolTip:tooltipTemplate},new go.Binding("fill","d_fill"),new go.Binding("stroke","d_stroke")),GO(go.Panel,"Auto",{margin:12},new go.Binding("margin","width",function(e){return 12*e/60*1.2}),new go.Binding("opacity","text",function(e){return console.log(e.length),0!=e.length}),GO(go.Shape,"Rectangle",{fill:null,stroke:null,margin:new go.Margin(5,0,0,0)},new go.Binding("fill","isSelected",function(e){return e?"#FFC106":null}).ofObject("")),GO(go.TextBlock,{margin:6,font:"bold 12pt Segoe UI, sans-serif",stroke:"#333"},new go.Binding("text","text",function(e){return e}),new go.Binding("stroke","isSelected",function(e){return e?"#fff":"#333"}).ofObject(""))),{selectionAdornmentTemplate:GO(go.Adornment,"Vertical",GO(go.Shape,"RoundedRectangle",{width:100,height:130,fill:null,stroke:null,strokeWidth:5,margin:new go.Margin(0,0,0,0)}),GO(go.Placeholder))},{selectionAdorned:!1})),myDiagram.nodeTemplateMap.add("square",GO(go.Node,"Auto",GO(go.Shape,"RoundedRectangle",{width:120,height:64,fill:"#fff",stroke:"#D55500",strokeWidth:2},new go.Binding("d_fill"),new go.Binding("d_stroke")),GO(go.TextBlock,{name:"icon_label",opacity:1,margin:8,maxSize:new go.Size(200,NaN),wrap:go.TextBlock.WrapFit,stroke:"#D55500",editable:!0},new go.Binding("text").makeTwoWay()),new go.Binding("stroke","d_stroke"))),myDiagram.linkTemplate=GO(go.Link,go.Link.Bezier,{selectionAdornmentTemplate:linkSelectionAdornmentTemplate,fromEndSegmentLength:150,toEndSegmentLength:150,zOrder:1,adjusting:go.Link.End},{doubleClick:function(){send_newGraph("属性")}},{},new go.Binding("points").makeTwoWay(),GO(go.Shape,{opacity:1,isPanelMain:!0,stroke:"#BDBDBD",strokeWidth:1,fill:"#BDBDBD"},new go.Binding("strokeWidth","money",function(e){return 1e6<e?4:1e5<e?3:1e5<e?2:1}),new go.Binding("stroke","money",function(e){return 1e6<e?"red":1e5<e?"orange":1e5<e?"green":"#ccc"}),new go.Binding("stroke","patt",function(e){return""===e?"":"transparent"}),new go.Binding("pathPattern","patt",convertPathPatternToShape)),GO(go.Shape,{isPanelMain:!0,stroke:"white",strokeWidth:3,name:"PIPE",strokeDashArray:[10,10],opacity:0}),GO(go.TextBlock,"2/3",{segmentIndex:NaN,segmentFraction:.5,font:"bold 12pt Segoe UI, sans-serif",stroke:"#333"},new go.Binding("text","text",function(e){return e.replace(/(\r\n)|(\n)/g,"  ")})),GO(go.Shape,{name:"link_arrow",toArrow:"standard",stroke:"#BDBDBD",fill:"#BDBDBD"},new go.Binding("strokeWidth","money",function(e){return 1e6<e?4:1e5<e?3:1e5<e?2:1}),new go.Binding("stroke","money",function(e){return 1e6<e?"red":1e5<e?"orange":1e5<e?"green":"#ccc"})))}go.Diagram.inherit(Sankey_,go.LayeredDigraphLayout),Sankey_.prototype.makeNetwork=function(e){var i=go.LayeredDigraphLayout.prototype.makeNetwork.call(this,e);return this.diagram.nodes.each(function(e){var n=getAutoHeightForNode(e),t=e.findObject("SHAPE");t&&(t.height=n);var o=e.findObject("TEXT"),t=e.findObject("LTEXT"),n="bold "+Math.max(12,Math.round(n/8))+"pt Segoe UI, sans-serif";o&&(o.font=n),t&&(t.font=n);n=i.findVertex(e);null!==n&&(e.ensureBounds(),e=e.actualBounds,n.width=e.width,n.height=e.height,n.focusY=n.height/2)}),i},Sankey_.prototype.nodeMinColumnSpace=function(e,n){if(null!==e.node)return go.LayeredDigraphLayout.prototype.nodeMinColumnSpace.call(this,e,n);if(1<=e.edgesCount){for(var t=1,o=e.edges;o.next();){var i=o.value;if(null!=i.link){i=i.link.computeThickness();t<i&&(t=i);break}}return Math.max(2,Math.ceil(t/this.columnSpacing))}return 2},Sankey_.prototype.nodeMinLayerSpace=function(e,n){return null===e.node?100:go.LayeredDigraphLayout.prototype.nodeMinLayerSpace.call(this,e,n)},Sankey_.prototype.assignLayers=function(){go.LayeredDigraphLayout.prototype.assignLayers.call(this);var o=this.network;o.findAllParts().each(function(e){var n,t;e instanceof go.Link&&(n=o.findVertex(e.fromNode),t=o.findVertex(e.toNode),n.layer<t.layer&&(o.deleteLink(e),e.routing=go.Link.AvoidsNodes,e.curve=go.Link.None))})};