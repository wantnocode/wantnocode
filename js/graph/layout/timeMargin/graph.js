"use strict";var myDiagram,myOverview;function init(n,e,i,o,t){o=go.GraphObject.make;function a(e){return 80*((e=Math.max(e,1))-1)}null!=myDiagram&&(myDiagram.div=null),(myDiagram=o(go.Diagram,"myDiagramDiv_timeMargin",{"animationManager.isEnabled":!1,"toolManager.hoverDelay":200,initialAutoScale:go.Diagram.Uniform,isReadOnly:!0,grid:o(go.Panel,"Grid",{gridCellSize:new go.Size(60,80),gridOrigin:new go.Point(0,-55)},o(go.Shape,"LineH",{stroke:"lightgray"})),"draggingTool.isGridSnapEnabled":!0,"resizingTool.isGridSnapEnabled":!0,scrollMode:go.Diagram.InfiniteScroll,positionComputation:function(e,i){var n=i.y;return(e.documentBounds.height<e.viewportBounds.height||(n=Math.min(n,e.documentBounds.bottom-e.viewportBounds.height))<0)&&(n=0),new go.Point(i.x,n)},linkTemplate:o(go.Link,{zOrder:1,fromEndSegmentLength:150,toEndSegmentLength:150,adjusting:go.Link.End,selectionAdorned:!1},new go.Binding("zOrder","isSelected",function(e){return e?3:1}).ofObject(),o(go.Shape,{opacity:1,isPanelMain:!0,stroke:"#000",strokeWidth:1,fill:"#000"},new go.Binding("fill","d_fill"),new go.Binding("stroke","d_stroke"),new go.Binding("strokeWidth","width"),new go.Binding("stroke","isSelected",function(e,i){return e?"#167cF3":i.part.data.d_stroke}).ofObject()),o(go.Panel,"Auto",o(go.Shape,{fill:"#fff",stroke:"gray"},new go.Binding("fill","isSelected",function(e){return e?"#FFC106":"#fff"}).ofObject()),o(go.TextBlock,{margin:3,text:"描述"},new go.Binding("text","text"))),o(go.Shape,{name:"link_arrow",toArrow:"standard",stroke:"#000",fill:"#000"},new go.Binding("stroke","isSelected",function(e,i){return e?"#167cF3":i.part.data.d_stroke}).ofObject(),new go.Binding("fill","isSelected",function(e,i){return e?"#167cF3":i.part.data.d_stroke}).ofObject(),new go.Binding("strokeWidth","width"))),ModelChanged:function(e){e.isTransactionFinished},"undoManager.isEnabled":!0})).nodeTemplateMap.add("",o(go.Node,"Auto",{zOrder:2,height:10,selectionAdorned:!1,layerName:"Background",dragComputation:function(){},resizable:!0,resizeAdornmentTemplate:o(go.Adornment,"Spot",o(go.Placeholder),o(go.Shape,{alignment:go.Spot.Right,cursor:"col-resize",desiredSize:new go.Size(8,8),fill:"dodgerblue"})),toolTip:o("ToolTip",o(go.TextBlock,new go.Binding("text","",function(e){return e.text})))},new go.Binding("position","",function(e){return new go.Point(200*t.indexOf(e.time)+80,a(e.row)+100)}),new go.Binding("width","length",function(e){return 10}).makeTwoWay(function(e){return e/60}),o(go.Shape,"Ellipse",{fill:"white",stroke:null},new go.Binding("fill","d_fill")))),myDiagram.nodeTemplateMap.add("RowHeader",o(go.Node,"Vertical",{selectionAdorned:!1,layerName:"Foreground",width:300},o(go.Shape,"Ellipse",{fill:"white",width:30,height:30,stroke:null},new go.Binding("fill","fill")),o(go.Picture,{width:15,height:15,margin:new go.Margin(-22,0,10,0)},new go.Binding("source","icon",function(e){return"./icon/"+e+".svg"})),o(go.TextBlock,new go.Binding("text")))),myDiagram.nodeTemplateMap.add("TimeHeader",o(go.Node,"Vertical",{selectionAdorned:!1,layerName:"Foreground"},o(go.TextBlock,new go.Binding("text")))),null!=myOverview&&(myOverview.div=null),myOverview=o(go.Overview,"myOverviewDIV_timeMargin",{observed:myDiagram,contentAlignment:go.Spot.Center,minScale:.05}),myDiagram.addDiagramListener("InitialLayoutCompleted",function(e){var i={source:"timingEvents",events_name:"updateScale",events_id:1,scale:myDiagram.scale};window.parent.postMessage(i,"*"),n.map(function(e){var i=e;i.isRow=1,i.row_=e.row,i.category="RowHeader",myDiagram.model.addNodeData(i)}),t.map(function(e,i){var n={};n.key=e;n.text=new Date(e).toLocaleDateString("zh-cn",{month:"short",day:"2-digit",year:"numeric",hour:"numeric",minute:"numeric"}),n.isTime=1,n.category="TimeHeader",n.timeIndex=i,myDiagram.model.addNodeData(n)}),myDiagram.nodes.each(function(e){e.data.isRow?e.position=new go.Point(myDiagram.viewportBounds.x+0,a(e.data.row_)+84):e.data.isTime?e.position=new go.Point(200*e.data.timeIndex,0):e.position.x<myDiagram.viewportBounds.x+300?e.part.visible=!1:e.part.visible=!0});window.parent.postMessage({source:"timingEvents",event_name:"布局加载完成"},"*")}),myDiagram.addDiagramListener("ViewportBoundsChanged",function(e){myDiagram.viewportBounds;myDiagram.nodes.each(function(e){e.data.isRow?e.position=new go.Point(myDiagram.viewportBounds.x+0,a(e.data.row_)+84):e.data.isTime?e.position=new go.Point(200*e.data.timeIndex,myDiagram.viewportBounds.y):e.position.x<myDiagram.viewportBounds.x+300?e.part.visible=!1:e.part.visible=!0});var i={source:"timingEvents",events_name:"updateScale",events_id:1,scale:4*myDiagram.scale};window.parent.postMessage(i,"*")}),myDiagram.model.nodeDataArray=e,myDiagram.model.linkDataArray=i,myDiagram.scrollMode=go.Diagram.InfiniteScroll}