"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _defineProperty(e,t,n){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _toPropertyKey(e){e=_toPrimitive(e,"string");return"symbol"===_typeof(e)?e:String(e)}function _toPrimitive(e,t){if("object"!==_typeof(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);t=n.call(e,t||"default");if("object"!==_typeof(t))return t;throw new TypeError("@@toPrimitive must return a primitive value.")}function x_SankeyLayout(){go.TreeLayout.call(this)}go.Diagram.inherit(x_SankeyLayout,go.TreeLayout),x_SankeyLayout.prototype.makeNetwork=function(e){var i=go.LayeredDigraphLayout.prototype.makeNetwork.call(this,e);return this.diagram.nodes.each(function(e){var t=getAutoHeightForNode(e),n=e.findObject("SHAPE");n&&(n.height=t);var o=e.findObject("TEXT"),n=e.findObject("LTEXT"),t="bold "+Math.max(12,Math.round(t/8))+"pt Segoe UI, sans-serif";o&&(o.font=t),n&&(n.font=t);t=i.findVertex(e);null!==t&&(e.ensureBounds(),e=e.actualBounds,t.width=e.width,t.height=e.height,t.focusY=t.height/2)}),i},x_SankeyLayout.prototype.nodeMinColumnSpace=function(e,t){if(null!==e.node)return go.LayeredDigraphLayout.prototype.nodeMinColumnSpace.call(this,e,t);if(1<=e.edgesCount){for(var n=1,o=e.edges;o.next();){var i=o.value;if(null!=i.link){i=i.link.computeThickness();n<i&&(n=i);break}}return Math.max(2,Math.ceil(n/this.columnSpacing))}return 2},x_SankeyLayout.prototype.nodeMinLayerSpace=function(e,t){return null===e.node?100:go.LayeredDigraphLayout.prototype.nodeMinLayerSpace.call(this,e,t)},x_SankeyLayout.prototype.assignLayers=function(){go.LayeredDigraphLayout.prototype.assignLayers.call(this);for(var e=this.maxLayer,t=this.network.vertexes.iterator;t.next();){var n=t.value;n.node;0==n.destinationVertexes.count&&(n.layer=0),0==n.sourceVertexes.count&&(n.layer=e)}},x_SankeyLayout.prototype.commitLayout=function(){go.LayeredDigraphLayout.prototype.commitLayout.call(this);for(var e=this.network.edges.iterator;e.next();){var t=e.value.link;t&&t.curve===go.Link.Bezier&&t.invalidateRoute()}};var animation=new go.Animation;function fast_sankey_layout(){graph_layout_type=1,myDiagram.div=null,myDiagram=GO(go.Diagram,Diagram_name,{initialAutoScale:go.Diagram.Uniform,"animationManager.isEnabled":!1,ModelChanged:function(){},layout:GO(x_SankeyLayout,{layerSpacing:500})}),initOverview(),myDiagram.nodeTemplateMap.add("",GO(go.Node,"Vertical",{visible:!0,zOrder:2,locationObjectName:"SHAPE",locationSpot:go.Spot.MiddleLeft,layerName:"Foreground"},new go.Binding("visible"),new go.Binding("location","loc",function(e,t){return 1==t.data.isLocking?(t.isLayoutPositioned=!1,t.part.movable=!1,new go.Point(t.data.lock.x,t.data.lock.y)):new go.Point.parse(e)}).makeTwoWay(go.Point.stringify),{doubleClick:function(){send_newGraph("属性")}},GO(go.Shape,(_defineProperty(e={name:"SHAPE",figure:"Rectangle",stroke:null,strokeWidth:5,portId:"",fromSpot:go.Spot.RightSide,toSpot:go.Spot.LeftSide},"portId",""),_defineProperty(e,"cursor","pointer"),_defineProperty(e,"fromLinkable",!1),_defineProperty(e,"toLinkable",!1),_defineProperty(e,"width",20),_defineProperty(e,"opacity",1),e),{toolTip:tooltipTemplate},new go.Binding("fill","d_fill"),new go.Binding("stroke","d_stroke")),GO(go.Shape,"RoundedRectangle",{name:"entity_label",margin:new go.Margin(-60,0,0,105),fill:"red",cursor:"pointer",width:60,height:18,opacity:0},{toolTip:tooltipTemplate_label1},new go.Binding("opacity","tags",function(e){return 0!=labelisShow&&0<e[0].style.width?1:0}),new go.Binding("fill","tags",function(e){return e[0].style.fill}),new go.Binding("stroke","tags",function(e){return e[0].style.stroke})),GO(go.Shape,"RoundedRectangle",{name:"entity_label2",margin:new go.Margin(2,0,0,105),fill:"red",cursor:"pointer",width:60,height:18,opacity:0},{toolTip:tooltipTemplate_label2},new go.Binding("opacity","tags",function(e){return 0!=labelisShow&&0<e[1].style.width?1:0}),new go.Binding("fill","tags",function(e){return e[1].style.fill}),new go.Binding("stroke","tags",function(e){return e[1].style.stroke})),GO(go.Shape,"RoundedRectangle",{name:"entity_label3",margin:new go.Margin(2,0,0,105),fill:"red",cursor:"pointer",width:60,height:18,opacity:0},{toolTip:tooltipTemplate_label3},new go.Binding("opacity","tags",function(e){return 0!=labelisShow&&0<e[2].style.width?1:0}),new go.Binding("fill","tags",function(e){return e[2].style.fill}),new go.Binding("stroke","tags",function(e){return e[2].style.stroke})),GO(go.TextBlock,{name:"entity_label_text1",text:"",cursor:"pointer",opacity:0,stroke:"#333",margin:new go.Margin(-58,0,0,95)},{toolTip:tooltipTemplate_label1},new go.Binding("opacity","tags",function(e){return 0!=labelisShow&&0<e[0].style.width?1:0}),new go.Binding("text","tags",function(e){return 5<strlen(e[0].text)?e[0].text.slice(0,2)+"...":e[0].text}),new go.Binding("stroke","tags",function(e){return e[0].style.font_color})),GO(go.TextBlock,{name:"entity_label_text_x1",text:"X",cursor:"pointer",opacity:0,stroke:"#fff",margin:new go.Margin(-18,0,0,150)},{click:function(e,t){1==t.opacity&&delete_lable(1)}},new go.Binding("opacity","tags",function(e){return 0!=labelisShow&&0<e[0].style.width?1:0})),GO(go.TextBlock,{name:"entity_label_text2",text:"",cursor:"pointer",opacity:0,stroke:"#333",margin:new go.Margin(3,0,0,95)},{toolTip:tooltipTemplate_label2},new go.Binding("opacity","tags",function(e){return 0!=labelisShow&&0<e[1].style.width?1:0}),new go.Binding("text","tags",function(e){return 5<strlen(e[1].text)?e[1].text.slice(0,2):e[1].text}),new go.Binding("stroke","tags",function(e){return e[1].style.font_color})),GO(go.TextBlock,{name:"entity_label_text_x2",text:"X",cursor:"pointer",opacity:0,stroke:"#fff",margin:new go.Margin(-17,0,0,150)},{click:function(e,t){1==t.opacity&&delete_lable(2)}},new go.Binding("opacity","tags",function(e){return 0!=labelisShow&&0<e[1].style.width?1:0})),GO(go.TextBlock,{name:"entity_label_text3",text:"",cursor:"pointer",opacity:0,stroke:"#333",margin:new go.Margin(5,0,0,95)},{toolTip:tooltipTemplate_label3},new go.Binding("opacity","tags",function(e){return 0!=labelisShow&&0<e[2].style.width?1:0}),new go.Binding("text","tags",function(e){return 5<strlen(e[2].text)?e[2].text.slice(0,2):e[2].text}),new go.Binding("stroke","tags",function(e){return e[2].style.font_color})),GO(go.TextBlock,{name:"entity_label_text_x3",text:"X",cursor:"pointer",opacity:0,stroke:"#fff",margin:new go.Margin(-17,0,0,150)},{click:function(e,t){1==t.opacity&&delete_lable(3)}},new go.Binding("opacity","tags",function(e){return 0!=labelisShow&&0<e[2].style.width?1:0})),GO(go.Panel,"Auto",{name:"node_Text",visible:!1},GO(go.Shape,"Rectangle",{fill:null,stroke:null},new go.Binding("fill","isSelected",function(e){return e?"#FFC106":null}).ofObject("")),GO(go.TextBlock,{margin:3},new go.Binding("text","text"),new go.Binding("stroke","isSelected",function(e){return e?"#FFF":"#333"}).ofObject(""))),{selectionAdornmentTemplate:GO(go.Adornment,"Auto",GO(go.Shape,"RoundedRectangle",{width:100,height:130,fill:null,stroke:null,strokeWidth:5,margin:new go.Margin(0,0,0,0)}),GO(go.Placeholder))})),myDiagram.nodeTemplateMap.add("square",GO(go.Node,"Auto",GO(go.Shape,"RoundedRectangle",{width:120,height:64,fill:"#fff",stroke:"#D55500",strokeWidth:2},new go.Binding("d_fill"),new go.Binding("d_stroke")),GO(go.TextBlock,{name:"icon_label",visible:1,margin:8,maxSize:new go.Size(200,NaN),wrap:go.TextBlock.WrapFit,stroke:"#D55500",editable:!0},new go.Binding("text").makeTwoWay()),new go.Binding("stroke","d_stroke")));var e=GO(go.Adornment,"Link",GO(go.Shape,{isPanelMain:!0,fill:null,stroke:"blue",strokeWidth:3}));myDiagram.linkTemplate=GO(go.Link,go.Link.Bezier,{zOrder:1,name:"link_",selectionAdornmentTemplate:e,fromEndSegmentLength:150,toEndSegmentLength:150,adjusting:go.Link.End},{doubleClick:function(){send_newGraph("属性")}},{toolTip:tooltipTemplate_link},new go.Binding("points").makeTwoWay(),GO(go.Shape,{opacity:1,isPanelMain:!0,stroke:"#BDBDBD",strokeWidth:1,fill:"#BDBDBD"},new go.Binding("fill","d_stroke"),new go.Binding("stroke","d_stroke"),new go.Binding("strokeWidth","width"),new go.Binding("stroke","patt",function(e){return""===e?"":"transparent"}),new go.Binding("pathPattern","patt",convertPathPatternToShape)),GO(go.Shape,{isPanelMain:!0,stroke:"white",strokeWidth:3,name:"PIPE",strokeDashArray:[10,10],opacity:0}),GO(go.TextBlock,{name:"edge_label",textAlign:"center",stroke:"#000",visible:!1},new go.Binding("text","text",function(e){return e.replace(/(\r\n)|(\n)/g,"  ")})),GO(go.Shape,{name:"link_arrow",toArrow:"standard",stroke:"#BDBDBD",fill:"#BDBDBD",visible:!0},new go.Binding("fill","d_stroke"),new go.Binding("stroke","d_stroke"),new go.Binding("visible","direction",function(e){return 0!==e&&(1===e||2!==e&&(3===e||void 0))})),GO(go.Shape,{name:"link_arrow",fromArrow:"Backward",stroke:"#BDBDBD",fill:"#BDBDBD",visible:!1},new go.Binding("fill","d_stroke"),new go.Binding("stroke","d_stroke"),new go.Binding("visible","direction",function(e){return 0!==e&&(1!==e&&(2===e||(3===e||void 0)))})))}animation.easing=go.Animation.EaseLinear;